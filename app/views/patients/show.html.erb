<div class="row">
  <div class="col-xs-10 col-centered">
    <h1><%= "#{@patient.first_name} #{@patient.last_name}" %></h1>
    <hr>
    <div class="btn-group btn-group-sm" role="group">
      <%= link_to "New Visit", new_visit_path(patient: @patient.id), type: "button", method: :get, class: "btn btn-secondary btn-success" %>
      <%= link_to "Edit Patient", edit_patient_path(id: @patient.id), type: "button", method: :get, class: "btn btn-secondary" %>
      <%= link_to "Destroy Patient", patient_path(id: @patient.id), method: :delete, type: "button", class: "btn btn-secondary", data: { confirm: "Are you sure you want to delete Patient #{@patient.id} and all associated records?" } %>
    </div>
    <br /><br />
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Patient</h3>
      </div>
      <div class="panel-body">
        <ul class="list-group">
          <li class="list-group-item"><h5>Date of Birth:</h5> <%= @patient.date_of_birth ? @patient.date_of_birth.strftime("%d %B %Y") : "Not noted"%> </li>
          <li class="list-group-item"><h5>Sex:</h5> <%= @gender %></li>
          <li class="list-group-item"><h5>Mailing Address: </h5>
            <% if @patient.address_line_1.empty? %>
              not noted
            <% else %>
              <%= @patient.address_line_1 %>
              <%= @patient.address_line_2 %>
              <%= @patient.address_line_3 %>
              <br />
              <%= "#{@patient.city}, #{@patient.state} #{@patient.postal_code}" %>
              <br />
              <%= @patient.country %>
            <% end %>
          </li>
        </ul>
      </div>
    </div>
    <% if @visits.length != 0 %>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Primary Clinician</h3>
      </div>
      <div class="panel-body clickable" style="cursor:pointer;" onclick=<%= "location.href='/clinicians/" + "#{@primary_clinician.id}'" %>>
        <%= "#{@primary_clinician.first_name} #{@primary_clinician.last_name} at #{@primary_clinician.practice_name}" %>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Visits</h3>
      </div>
      <table class="table table-striped table-hover">
        <tr>
          <th>Date</th>
          <th>Reason for Visit</th>
          <th>Clinician</th>
        </tr>
        <% @visits.each do |v| %>
          <% @doctor = Clinician.where(id: v.clinician_id)[0] %>
          <tr style="cursor:pointer;" onclick=<%= "location.href='/visits/" + "#{v.id}'" %>>
            <td><%= v.created_at.strftime("%d %B %Y") %></td>
            <td><%= v.primary_reason %></td>
            <td><%= link_to "#{@doctor.first_name} #{@doctor.last_name}", clinician_path(@doctor.id) %></td>
          </tr>
        <% end %>
      </table>
    <% else %>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Visits</h3>
      </div>
      <div class="panel-body">
        <h5>Patient does not have any Visits yet.</h5>
      </div>
    <% end %>
    </div>
  </div>
</div>
