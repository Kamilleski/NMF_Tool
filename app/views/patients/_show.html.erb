<% @visits = Visit.where(patient_id: @patient.id) %>
<%= render "patients/patient_info_header" %>
<% if @visits.length != 0 %>
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">Primary Clinician</h3>
    </div>
    <div class="panel-body clickable" style="cursor:pointer;" onclick=<%= "location.href='/clinicians/" + "#{@primary_clinician.id}'" %>>
      <%= "#{@primary_clinician.first_name} #{@primary_clinician.last_name} at #{@primary_clinician.practice_name}" %>
    </div>
  </div>
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">Visits</h3>
    </div>
    <table class="table table-striped table-hover">
      <tr>
        <th>Date</th>
        <th>Reason for Visit</th>
        <th>Clinician</th>
      </tr>
      <% @visits.each do |v| %>
        <% @doctor = Clinician.where(id: v.clinician_id)[0] %>
        <tr style="cursor:pointer;" onclick=<%= "location.href='/visits/" + "#{v.id}'" %>>
          <td><%= v.created_at.strftime("%d %B %Y") %></td>
          <td><%= v.primary_reason %></td>
          <td><%= link_to "#{@doctor.first_name} #{@doctor.last_name}", clinician_path(@doctor.id) %></td>
        </tr>
      <% end %>
    </table>
<% else %>
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">Visits</h3>
    </div>
    <div class="panel-body">
      <h5>Patient does not have any Visits yet.</h5>
    </div>
<% end %>
</div>

<%= render "visits/show_tables/family_members", display_location: "patient_show", family_members: family_members %><%= render "visits/show_tables/procedures", display_location: "patient_show", procedures: procedures %>

<%= render "visits/show_tables/hospitalizations", display_location: "patient_show", hospitalizations: hospitalizations %>
<%= render "visits/show_tables/tests", tests: tests, display_location: "patient_show" %>
<%= render "visits/show_tables/symptoms", symptoms: symptoms, display_location: "patient_show" %>
